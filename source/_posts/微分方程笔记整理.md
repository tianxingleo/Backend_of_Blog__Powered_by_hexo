---
title: 微分方程笔记整理
date: 2025-12-15 19:44:08
tags:
  - 高数
  - 微分方程
  - 笔记
---

# 微分方程笔记

## 一、可分离变量形

**形式：** $\frac{dy}{dx} = f(x)g(y)$

**解法：** 分离变量：$\frac{dy}{g(y)} = f(x)dx$ 两边积分：$\int \frac{dy}{g(y)} = \int f(x)dx$

**例：** $\sqrt{1-x^2} y' = \sqrt{1-y^2}$ 解：

$$\sqrt{1-x^2} \frac{dy}{dx} = \sqrt{1-y^2}$$

分离变量：

$$(1-y^2)^{-1/2} dy = (1-x^2)^{-1/2} dx$$

两边积分：

$$\int (1-y^2)^{-1/2} dy = \int (1-x^2)^{-1/2} dx$$

得：

$$\arcsin y = \arcsin x + C$$

## 二、齐次方程

**形式：** $\frac{dy}{dx} = g(\frac{y}{x})$

**解法：** 令 $u = \frac{y}{x}$ （即 $y = ux$, $y' = u'x + u$） 代入原方程：

$$u + x \frac{du}{dx} = g(u) \implies x \frac{du}{dx} = g(u) - u$$

分离变量：

$$\frac{du}{g(u)-u} = \frac{dx}{x}$$

**例：** $\frac{dy}{dx} = \frac{y}{x} - \frac{1}{2}(\frac{y}{x})^3$，满足 $y|_{x=1} = 1$ 的特解为 ______ 解： 令 $u = \frac{y}{x}$，则 $y' = u + x u'$ 代入原方程：

$$u + x \frac{du}{dx} = u - \frac{1}{2}u^3$$

化简得：

$$x \frac{du}{dx} = -\frac{1}{2}u^3$$

分离变量：

$$\frac{du}{u^3} = -\frac{1}{2} \frac{dx}{x} \implies \int u^{-3} du = \int -\frac{1}{2} \frac{dx}{x}$$

积分得：

$$-\frac{1}{2} u^{-2} = -\frac{1}{2} \ln x + C_1$$

$$u^{-2} = \ln x + C \implies \frac{x^2}{y^2} = \ln x + C$$

$$y^2 = \frac{x^2}{\ln x + C}$$

由 $y|_{x=1} = 1$ (即 $x=1, y=1$)：

$$1 = \frac{1}{0 + C} \implies C = 1$$

故特解为：

$$y = \frac{x}{\sqrt{\ln x + 1}}$$

> **注（红笔）：** 求特解，不写 $|x|$，“$\pm x$”。

## 三、一阶线性微分方程

**形式：** $y' + p(x)y = q(x)$

- 若 $q(x) \equiv 0$，称为齐次。
- 否则为非齐次。

**公式：**

$$y = e^{-\int p(x)dx} \left[ \int q(x) e^{\int p(x)dx} dx + C \right]$$

**例：** $y=f(x)$ 过 $(1,1)$，其切线在纵轴截距等于切点横坐标，求曲线方程。 解： 设 $(x, y)$ 为曲线上点，$(X, Y)$ 为切线上点。 切线方程：

$$Y - y = y'(X - x)$$

即 $Y = y'X - y'x + y$ 令 $X=0$ (纵轴截距)，则 $Y|_{X=0} = y - y'x$。 根据题意“纵轴截距等于切点横坐标”：

$$y - y'x = x$$

整理得：

$$-xy' + y = x$$

$$y' - \frac{1}{x}y = -1$$

这是 $p(x) = -\frac{1}{x}, q(x) = -1$ 的一阶线性微分方程。 代入公式：

$$y = e^{-\int (-\frac{1}{x}) dx} \left[ \int (-1) e^{\int (-\frac{1}{x}) dx} dx + C \right]$$

$$= e^{\ln|x|} \left[ - \int \frac{1}{|x|} dx + C \right]$$

> **注（红笔）：** 一阶线性微分方程公式中 $e^{\int \dots dx}$ 可不带绝对值。

$$= x \left[ -\ln|x| + C \right] = C x - x\ln|x|$$

由 $y(1)=1$ (即 $x=1, y=1$)：

$$1 = C(1) - 0 \implies C=1$$

故方程为：$y = x(1 - \ln x)$

**例：** $f(x) + 2 \int_0^x f(t)dt = x^2$，求 $f(x)$。 解： 两边求导：

$$f'(x) + 2f(x) = 2x$$

（注：$f$ 任意阶可导） 这是一个一阶线性微分方程，$p(x)=2, q(x)=2x$。

$$f(x) = e^{-\int 2 dx} \left[ \int 2x e^{\int 2 dx} dx + C \right]$$

$$= e^{-2x} \left[ \int 2x e^{2x} dx + C \right]$$

$$= e^{-2x} \left[ x e^{2x} - \frac{1}{2} e^{2x} + C \right]$$

（注：积分部分用分部积分法 $\int u dv = uv - \int v du$）

$$= x - \frac{1}{2} + C e^{-2x}$$

代入原方程求 $C$： 令 $x=0$，原式变为 $f(0) + 0 = 0 \implies f(0) = 0$。 将 $f(0)=0$ 代入解中：

$$0 = 0 - \frac{1}{2} + C \implies C = \frac{1}{2}$$

故 $f(x) = x - \frac{1}{2} + \frac{1}{2} e^{-2x}$

**例：** 求 $y' = \frac{1}{xy + y^3}$ 的通解。 解：

$$\frac{dy}{dx} = \frac{1}{xy + y^3}$$

视为 $x$ 关于 $y$ 的函数：

$$\frac{dx}{dy} = xy + y^3$$

$$\frac{dx}{dy} - yx = y^3$$

这是关于 $x$ 的一阶线性方程，$p(y) = -y, q(y) = y^3$。

$$x = e^{\int y dy} \left[ \int y^3 e^{-\int y dy} dy + C \right]$$

$$= e^{\frac{y^2}{2}} \left[ \int y^3 e^{-\frac{y^2}{2}} dy + C \right]$$

计算积分 $\int y^3 e^{-\frac{y^2}{2}} dy$：令 $t = -\frac{y^2}{2}$ 或直接凑微分。 此处用凑微分：$\int y^2 e^{-\frac{y^2}{2}} y dy = \int y^2 e^{-\frac{y^2}{2}} d(\frac{y^2}{2})$ 更简单的做法：令 $u = \frac{y^2}{2}$，则 $du = y dy$，原式 $= \int 2u e^{-u} du$ 利用分部积分结果，最终得：

$$x = e^{\frac{y^2}{2}} \left[ (-y^2 - 2) e^{-\frac{y^2}{2}} + C \right]$$

$$x = -y^2 - 2 + C e^{\frac{y^2}{2}}$$

## 四、伯努利方程

**形式：** $y' + p(x)y = q(x)y^\alpha$ ($\alpha \neq 0, 1$)

**解法：**

1. 全式除以 $y^\alpha$：$y^{-\alpha}y' + p(x)y^{1-\alpha} = q(x)$

2. 令 $z = y^{1-\alpha}$ 求导：$z' = (1-\alpha)y^{-\alpha}y'$ $\implies y^{-\alpha}y' = \frac{1}{1-\alpha}z'$

3. 方程转化为线性方程：

   $$\frac{1}{1-\alpha}z' + p(x)z = q(x)$$

   即 $z' + (1-\alpha)p(x)z = (1-\alpha)q(x)$

**例：** 求方程 $y' + \frac{4x}{x^2-1}y = x y^{1/2}$ 解： $\alpha = 1/2$。 令 $z = y^{1-1/2} = y^{1/2}$。 则方程转化为：

$$z' + (1-\frac{1}{2})\frac{4x}{x^2-1} z = (1-\frac{1}{2})x$$

$$z' + \frac{2x}{x^2-1} z = \frac{1}{2}x$$

利用一阶线性方程公式：

$$z = e^{-\int \frac{2x}{x^2-1} dx} \left[ \int \frac{1}{2}x \cdot e^{\int \frac{2x}{x^2-1} dx} dx + C \right]$$

其中 $\int \frac{2x}{x^2-1} dx = \ln|x^2-1|$。

$$z = e^{-\ln|x^2-1|} \left[ \int \frac{1}{2}x (x^2-1) dx + C \right]$$

$$z = \frac{1}{x^2-1} \left[ \int (\frac{1}{2}x^3 - \frac{1}{2}x) dx + C \right]$$

$$z = \frac{1}{x^2-1} (\frac{1}{8}x^4 - \frac{1}{4}x^2 + C)$$

最后代回 $y = z^2$ (即 $z = \sqrt{y}$)。

## 五、二阶可降阶型

### 1. $y'' = f(x, y')$ 型（不显含 $y$）

**解法：** 令 $y' = p(x)$，则 $y'' = p'(x)$。 方程转化为 $p' = f(x, p)$ (一阶方程)。

### 2. $y'' = f(y, y')$ 型（不显含 $x$）

**解法：** 令 $p(y) = y'$。 由链式法则：$y'' = \frac{dp}{dx} = \frac{dp}{dy} \cdot \frac{dy}{dx} = p \frac{dp}{dy}$。 原方程转化为 $p \frac{dp}{dy} = f(y, p)$。

**例：** $xy'' + 3y' = 0$ 通解为 ______ 解：（类型 1，不显含 $y$） 令 $y' = p(x)$，则 $y'' = p'(x)$。

$$x p' + 3p = 0$$

$$p' + \frac{3}{x} p = 0$$

分离变量：$\frac{dp}{p} = -\frac{3}{x} dx$ 积分：$\ln p = -3\ln x + \ln C_1 \implies p = C_1 x^{-3}$ 即 $y' = \frac{C_1}{x^3}$

$$y = \int C_1 x^{-3} dx = \frac{C_1}{-2x^2} + C_2 = \frac{C_1}{x^2} + C_2$$

**例：** $yy'' + y'^2 = 0$，满足 $y(0)=1, y'(0)=\frac{1}{2}$，特解是 ______ 解：（类型 2，不显含 $x$） 令 $y' = p$，求 $y(x)$。 则 $y'' = p \frac{dp}{dy}$。 代入方程：

$$y \cdot p \frac{dp}{dy} + p^2 = 0$$

提取 $p$：$p(y \frac{dp}{dy} + p) = 0$。 若 $p=0$，不满足 $y'(0)=1/2$，舍去。 故 $y \frac{dp}{dy} + p = 0 \implies \frac{d(yp)}{dy} = 0 \implies yp = C_1$。 由 $x=0$ 时，$y=1, p=y'(0)=1/2$，得 $1 \cdot \frac{1}{2} = C_1 \implies C_1 = \frac{1}{2}$。 即 $y \cdot y' = \frac{1}{2}$。

$$y dy = \frac{1}{2} dx$$

两边积分（变量分离）：

$$\int y dy = \int \frac{1}{2} dx$$

$$\frac{1}{2} y^2 = \frac{1}{2} x + C_2$$

即 $y^2 = x + 2C_2$。 由 $y(0)=1 \implies 1 = 0 + 2C_2 \implies 2C_2 = 1$。 故 $y^2 = x + 1 \implies y = \sqrt{x+1}$。

## 六、n阶线性微分方程结构

**叠加原理：**

- 若 $y_1^*(x)$ 与 $y_2^*(x)$ 分别是 $y''+p(x)y'+q(x)y = f_1(x)$ 与 $y''+p(x)y'+q(x)y = f_2(x)$ 的解。
- 则 $y_1^*(x) + y_2^*(x)$ 是 $y''+p(x)y'+q(x)y = f_1(x) + f_2(x)$ 的解。

**定理 (齐次)：**

- 若 $y_1(x), y_2(x)$ 是齐次方程的两个解，则 $y = C_1 y_1(x) + C_2 y_2(x)$ 也是解。
- 若 $y_1, y_2, \dots, y_n$ 线性无关，则通解为 $C_1 y_1 + \dots + C_n y_n$。
- (注：二阶方程 $y_1, y_2$ 线性无关 $\iff \frac{y_1(x)}{y_2(x)} \neq C$)

**定理 (非齐次)：**

- 设 $y^*(x)$ 是非齐次方程的特解，$Y(x)$ 是对应齐次方程的通解。
- 则 $y = Y(x) + y^*(x)$ 是非齐次方程的通解。

**例：** 非齐次线性微分方程 $y' + p(x)y = q(x)$ 有两个不同解 $y_1(x), y_2(x)$。 ($C$ 为任意常数)，则该方程通解是 ______ 解：$y = C(y_1 - y_2) + y_1$ （因为 $y_1 - y_2$ 是齐次方程的解）。

## 七、二阶常系数线性微分方程

### 1. 齐次情形

**方程：** $y'' + py' + qy = 0$ **特征方程：** $\lambda^2 + p\lambda + q = 0$

求根 $\Delta = p^2 - 4q$：

1. $\Delta > 0$，两个不等实根 $\lambda_1 \neq \lambda_2$：

   $$y = C_1 e^{\lambda_1 x} + C_2 e^{\lambda_2 x}$$

2. $\Delta = 0$，两个相等实根 $\lambda_1 = \lambda_2 = \lambda$：

   $$y = (C_1 + C_2 x) e^{\lambda x}$$

3. $\Delta < 0$，一对共轭复根 $\lambda_{1,2} = \alpha \pm \beta i$：

   $$y = e^{\alpha x} (C_1 \cos \beta x + C_2 \sin \beta x)$$

**例：** $y'' - y' + \frac{1}{4}y = 0$ 解：特征方程 $\lambda^2 - \lambda + \frac{1}{4} = 0 \implies (\lambda - \frac{1}{2})^2 = 0$。 $\lambda_1 = \lambda_2 = \frac{1}{2}$。 通解 $y = (C_1 + C_2 x) e^{\frac{1}{2}x}$。

**例：** $y'' - 2y' - 3y = 0$ 的通解 ______ 解：$\lambda^2 - 2\lambda - 3 = 0 \implies (\lambda-3)(\lambda+1)=0$。 $\lambda_1 = 3, \lambda_2 = -1$。 通解 $y = C_1 e^{3x} + C_2 e^{-x}$。

**例：** $y'' - 2y' + 5y = 0$ 解：$\lambda^2 - 2\lambda + 5 = 0$。 $\Delta = 4 - 20 = -16$。 $\lambda = \frac{2 \pm 4i}{2} = 1 \pm 2i$ ($\alpha=1, \beta=2$)。 通解 $y = e^x (C_1 \cos 2x + C_2 \sin 2x)$。

### 2. 非齐次情形

**方程：** $y'' + py' + qy = f(x)$

#### 类型 I：$f(x) = P_m(x) e^{rx}$

- 设特解 $y^* = x^k Q_m(x) e^{rx}$
- 其中 $Q_m(x)$ 是与 $P_m(x)$ 同次的多项式。
- $k$ **的取值 (修正项)：**
  - 若 $r$ 不是特征根，则 $k=0$。
  - 若 $r$ 是单特征根 ($\lambda_1$ 或 $\lambda_2$)，则 $k=1$。
  - 若 $r$ 是重特征根 ($\lambda_1 = \lambda_2 = r$)，则 $k=2$。

**例：** $y'' - 4y = e^x(x+3)$ 解：特征方程 $\lambda^2 - 4 = 0 \implies \lambda = \pm 2$。 $f(x)$ 中 $r=1$。因 $1 \neq \pm 2$，故 $k=0$。 设 $y^* = e^x (Ax + B)$。

**例：** $y'' - 4y = e^{2x} \cdot x^2$ 解：$r=2$。因 $\lambda_1=2$，且为单根，故 $k=1$。 设 $y^* = x^1 e^{2x} (Ax^2 + Bx + C)$。

**例：** $y'' - 4y = -x+1$ 解：视为 $(-x+1)e^{0x}$，即 $r=0$。 $\lambda = \pm 2$，故 $k=0$。 设 $y^* = x^0 (Ax + B) = Ax + B$。

**例：** 求 $y'' + 4y' + 4y = e^{-2x}$ 的通解。 解：

1. 求齐次通解： $\lambda^2 + 4\lambda + 4 = 0 \implies (\lambda+2)^2 = 0 \implies \lambda_{1,2} = -2$。 $Y = (C_1 + C_2 x) e^{-2x}$。
2. 求特解： $f(x) = 1 \cdot e^{-2x}$，即 $r = -2$。 因 $-2$ 是二重根，故 $k=2$。 设 $y^* = x^2 \cdot A \cdot e^{-2x} = A x^2 e^{-2x}$。 求导代入原方程： $(A x^2 e^{-2x})'' + 4(A x^2 e^{-2x})' + 4(A x^2 e^{-2x}) = e^{-2x}$ 化简得 $2A e^{-2x} = e^{-2x} \implies A = \frac{1}{2}$。 即 $y^* = \frac{1}{2} x^2 e^{-2x}$。
3. 通解：$y = (C_1 + C_2 x) e^{-2x} + \frac{1}{2} x^2 e^{-2x}$。

#### 类型 II：$f(x) = e^{\alpha x} [P_l(x) \cos \beta x + Q_m(x) \sin \beta x]$

- 设特解 $y^* = x^k e^{\alpha x} [M_n(x) \cos \beta x + N_n(x) \sin \beta x]$
- 其中 $n = \max\{l, m\}$。
- $k$ **的取值：**
  - 若 $\alpha \pm \beta i$ 不是特征根，则 $k=0$。
  - 若 $\alpha \pm \beta i$ 是特征根，则 $k=1$。

**例：** $y'' - y' = \frac{1}{2} e^x - \cos 2x$ 解： 特征方程 $\lambda^2 - \lambda = 0 \implies \lambda_1=0, \lambda_2=1$。 将 $f(x)$ 分拆求解：

1. $f_1 = \frac{1}{2} e^x$ ($r=1$ 为单根 $\implies k=1$)：设 $y_1^* = A x e^x$。
2. $f_2 = -\cos 2x$ ($\alpha=0, \beta=2, 0 \pm 2i$ 不是根 $\implies k=0$)：设 $y_2^* = C \cos 2x + D \sin 2x$。 特解 $y^* = y_1^* + y_2^*$。

**例：** $y'' - 2y' + 5y = (x+1) e^{2x} \cos x + 2 e^{2x} \sin x$ 解： $\lambda^2 - 2\lambda + 5 = 0 \implies \lambda = 1 \pm 2i$。 $f(x)$ 中 $\alpha = 2, \beta = 1$，即 $2 \pm i$。 $2 \pm i \neq 1 \pm 2i$，不是特征根 $\implies k=0$。 设 $y^* = e^{2x} [(Ax+B)\cos x + (Cx+D)\sin x]$。

## 八、高阶常系数线性微分方程

**形式：** $y^{(n)} + a_1 y^{(n-1)} + \dots + a_n y = 0$

**特征方程：** $\lambda^n + a_1 \lambda^{n-1} + \dots + a_n = 0$

**通解结构：**

1. $k$ **个不同单实根** $\lambda_1, \dots, \lambda_k$： 对应项 $C_1 e^{\lambda_1 x} + \dots + C_k e^{\lambda_k x}$
2. $k$ **重实根** $\lambda$： 对应项 $(C_1 + C_2 x + \dots + C_k x^{k-1}) e^{\lambda x}$
3. $k$ **重复根** $\alpha \pm \beta i$： 对应项 $e^{\alpha x} [(C_1 + \dots + C_k x^{k-1}) \cos \beta x + (D_1 + \dots + D_k x^{k-1}) \sin \beta x]$

**例：** 求 $y^{(4)} - 2y^{(3)} + 5y^{(2)} = 0$ 通解。 解： 特征方程 $\lambda^4 - 2\lambda^3 + 5\lambda^2 = 0$ $\lambda^2 (\lambda^2 - 2\lambda + 5) = 0$ $\lambda_{1,2} = 0$ (二重实根)。 $\lambda_{3,4} = 1 \pm 2i$ (一对共轭复根)。 通解：

$$y = (C_1 + C_2 x) e^{0x} + e^{1x} [C_3 \cos 2x + C_4 \sin 2x]$$

$$y = C_1 + C_2 x + e^x (C_3 \cos 2x + C_4 \sin 2x)$$

## 九、欧拉方程

**形式：** $x^n y^{(n)} + a_1 x^{n-1} y^{(n-1)} + \dots + a_n y = f(x)$

**解法：**

1. 当 $x > 0$ 时，令 $x = e^t$ ($t = \ln x$)。
2. 记算子 $D = \frac{d}{dt}$ (注意 $Dy = \frac{dy}{dt}$)。 转换关系：
   - $x y' = Dy$
   - $x^2 y'' = D(D-1)y$
   - $x^3 y''' = D(D-1)(D-2)y$
   - ...
3. 将 $y(x)$ 转化为 $y(t)$，求出 $y(t)$ 后把 $t = \ln|x|$ 回代。

**例：** 求 $x^2 y'' + 4x y' + 2y = 0$ 的通解。 解： 令 $x = e^t$，记 $Dy = \frac{dy}{dt}$。 方程转化为：

$$D(D-1)y + 4Dy + 2y = 0$$

$$(D^2 - D + 4D + 2)y = 0$$

$$D^2 y + 3Dy + 2y = 0$$

$$y'' + 3y' + 2y = 0 \quad (\text{关于 } t \text{ 的方程})$$

特征方程：$\lambda^2 + 3\lambda + 2 = 0 \implies \lambda_1 = -1, \lambda_2 = -2$。

$$y(t) = C_1 e^{-t} + C_2 e^{-2t}$$

回代 $e^{-t} = \frac{1}{x}, e^{-2t} = \frac{1}{x^2}$：

$$y = C_1 \frac{1}{x} + C_2 \frac{1}{x^2}$$

